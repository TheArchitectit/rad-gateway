(()=>{var e={};e.id=882,e.ids=[882],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},9548:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>x,pages:()=>c,routeModule:()=>p,tree:()=>d}),s(4174),s(1740),s(5866);var r=s(3191),a=s(8716),i=s(7922),n=s.n(i),l=s(5231),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);s.d(t,o);let d=["",{children:["reports",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,4174)),"/mnt/ollama/git/RADAPI01/web/src/app/reports/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,1740)),"/mnt/ollama/git/RADAPI01/web/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"]}],c=["/mnt/ollama/git/RADAPI01/web/src/app/reports/page.tsx"],x="/reports/page",m={require:s,loadChunk:()=>Promise.resolve()},p=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/reports/page",pathname:"/reports",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},7984:(e,t,s)=>{Promise.resolve().then(s.bind(s,3815))},5649:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});let r=(0,s(2325).Z)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},5740:(e,t,s)=>{"use strict";s.d(t,{Hx:()=>i,x1:()=>n});let r=process.env.NEXT_PUBLIC_API_URL||"http://172.16.30.45:8090";class a{constructor(e){this.authToken=null,this.baseUrl=e.replace(/\/$/,"")}setAuthToken(e){this.authToken=e}getHeaders(){let e={"Content-Type":"application/json",Accept:"application/json"};return this.authToken&&(e.Authorization=`Bearer ${this.authToken}`),e}buildUrl(e,t){let s=new URL(`${this.baseUrl}${e}`);return t&&Object.entries(t).forEach(([e,t])=>{null!=t&&s.searchParams.set(e,String(t))}),s.toString()}async handleResponse(e){if(!e.ok){let t=await e.json().catch(()=>({error:{code:"unknown_error",message:"An unexpected error occurred"}}));throw new i(t.error.message,t.error.code,e.status,t.error.details,t.error.requestId)}if(204!==e.status)return e.json()}async get(e,t={}){let s=this.buildUrl(e,t.params),r=await fetch(s,{...t,method:"GET",headers:{...this.getHeaders(),...t.headers}});return this.handleResponse(r)}async post(e,t,s={}){let r=this.buildUrl(e,s.params),a=await fetch(r,{...s,method:"POST",headers:{...this.getHeaders(),...s.headers},body:t?JSON.stringify(t):null});return this.handleResponse(a)}async put(e,t,s={}){let r=this.buildUrl(e,s.params),a=await fetch(r,{...s,method:"PUT",headers:{...this.getHeaders(),...s.headers},body:t?JSON.stringify(t):null});return this.handleResponse(a)}async patch(e,t,s={}){let r=this.buildUrl(e,s.params),a=await fetch(r,{...s,method:"PATCH",headers:{...this.getHeaders(),...s.headers},body:t?JSON.stringify(t):null});return this.handleResponse(a)}async delete(e,t={}){let s=this.buildUrl(e,t.params),r=await fetch(s,{...t,method:"DELETE",headers:{...this.getHeaders(),...t.headers}});return this.handleResponse(r)}}class i extends Error{constructor(e,t,s,r,a){super(e),this.code=t,this.status=s,this.details=r,this.requestId=a,this.name="APIError"}isUnauthorized(){return 401===this.status}isForbidden(){return 403===this.status}isNotFound(){return 404===this.status}isValidationError(){return 400===this.status||422===this.status}}let n=new a(r)},3815:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>m});var r=s(326),a=s(7577);let i=(0,s(2325).Z)("file-down",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);var n=s(5649),l=s(8350),o=s(5030),d=s(4583),c=s(5740);function x(e,t){let s=new Date(e);return Number.isNaN(s.getTime())?t:s.toISOString()}function m(){let e=(0,a.useMemo)(()=>(function(){let e=new Date;return{startTime:new Date(e.getTime()-6048e5).toISOString(),endTime:e.toISOString()}})(),[]),[t,s]=(0,a.useState)(""),[m,p]=(0,a.useState)(e.startTime.slice(0,16)),[h,u]=(0,a.useState)(e.endTime.slice(0,16)),[g,v]=(0,a.useState)(null),[j,b]=(0,a.useState)(""),[f,k]=(0,a.useState)(null),[N,y]=(0,a.useState)(null),[w,T]=(0,a.useState)(null),P=(0,a.useMemo)(()=>{let s={startTime:x(m,e.startTime),endTime:x(h,e.endTime)};return t.trim()&&(s.workspaceId=t.trim()),s},[m,h,t]),S=async()=>{v("usage"),b(""),y(null);try{let e=await c.x1.get("/v0/admin/reports/usage",{params:P});k(e)}catch(e){b(e instanceof Error?e.message:"Failed to load usage report")}finally{v(null)}},A=async()=>{v("performance"),b(""),k(null);try{let e=await c.x1.get("/v0/admin/reports/performance",{params:P});y(e)}catch(e){b(e instanceof Error?e.message:"Failed to load performance report")}finally{v(null)}},R=async e=>{v("export"),b("");try{let t=await c.x1.post("/v0/admin/reports/export",void 0,{params:{format:e}});T(t)}catch(e){b(e instanceof Error?e.message:"Failed to create report export")}finally{v(null)}};return r.jsx(l.L,{children:(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-3xl font-bold text-[var(--ink-900)]",children:"Advanced Reports"}),r.jsx("p",{className:"text-[var(--ink-500)]",children:"Generate usage and performance dossiers with export-ready snapshots."})]}),r.jsx(o.Z,{children:(0,r.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 xl:grid-cols-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"mb-1.5 block text-xs font-semibold uppercase tracking-[0.1em] text-[var(--ink-500)]",children:"Workspace ID"}),r.jsx("input",{value:t,onChange:e=>s(e.target.value),placeholder:"Optional workspace",className:"ui-input"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"mb-1.5 block text-xs font-semibold uppercase tracking-[0.1em] text-[var(--ink-500)]",children:"Start Time"}),r.jsx("input",{type:"datetime-local",value:m,onChange:e=>p(e.target.value),className:"ui-input"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"mb-1.5 block text-xs font-semibold uppercase tracking-[0.1em] text-[var(--ink-500)]",children:"End Time"}),r.jsx("input",{type:"datetime-local",value:h,onChange:e=>u(e.target.value),className:"ui-input"})]}),(0,r.jsxs)("div",{className:"flex flex-wrap items-end gap-2",children:[r.jsx(d.z,{onClick:()=>void S(),loading:"usage"===g,children:"Load Usage"}),r.jsx(d.z,{variant:"secondary",onClick:()=>void A(),loading:"performance"===g,children:"Load Performance"})]})]})}),r.jsx(o.Z,{title:"Exports",children:(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,r.jsxs)(d.z,{variant:"secondary",onClick:()=>void R("json"),loading:"export"===g,children:[r.jsx(i,{className:"mr-2 h-4 w-4"}),"Export JSON"]}),(0,r.jsxs)(d.z,{variant:"secondary",onClick:()=>void R("csv"),loading:"export"===g,children:[r.jsx(i,{className:"mr-2 h-4 w-4"}),"Export CSV"]}),"export"===g&&(0,r.jsxs)("span",{className:"inline-flex items-center gap-2 text-sm text-[var(--ink-500)]",children:[r.jsx(n.Z,{className:"h-4 w-4 animate-spin"}),"Preparing export..."]}),w&&(0,r.jsxs)("div",{className:"text-sm text-[var(--ink-700)]",children:["Export ",r.jsx("span",{className:"font-semibold text-[var(--ink-900)]",children:w.exportId})," is ",w.status," \xb7"," ",r.jsx("a",{className:"text-[var(--status-info)] underline-offset-2 hover:underline",href:w.downloadUrl,children:"download"})]})]})}),j&&r.jsx(o.Z,{className:"border border-[rgba(152,43,33,0.3)] bg-[rgba(152,43,33,0.08)]",children:r.jsx("p",{className:"text-sm text-[var(--status-critical)]",children:j})}),f&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,r.jsxs)(o.Z,{children:[r.jsx("div",{className:"text-sm text-[var(--ink-500)]",children:"Requests"}),r.jsx("div",{className:"mt-1 text-2xl font-bold text-[var(--ink-900)]",children:f.summary.totalRequests.toLocaleString()})]}),(0,r.jsxs)(o.Z,{children:[r.jsx("div",{className:"text-sm text-[var(--ink-500)]",children:"Tokens"}),r.jsx("div",{className:"mt-1 text-2xl font-bold text-[var(--ink-900)]",children:f.summary.totalTokens.toLocaleString()})]}),(0,r.jsxs)(o.Z,{children:[r.jsx("div",{className:"text-sm text-[var(--ink-500)]",children:"Cost"}),(0,r.jsxs)("div",{className:"mt-1 text-2xl font-bold text-[var(--ink-900)]",children:["$",f.summary.totalCostUsd.toFixed(2)]})]}),(0,r.jsxs)(o.Z,{children:[r.jsx("div",{className:"text-sm text-[var(--ink-500)]",children:"Success Rate"}),(0,r.jsxs)("div",{className:"mt-1 text-2xl font-bold text-[var(--status-normal)]",children:[(100*f.summary.successRate).toFixed(2),"%"]})]})]}),r.jsx(o.Z,{title:"Usage Report Records",children:r.jsx("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full",children:[r.jsx("thead",{children:(0,r.jsxs)("tr",{className:"border-b border-[var(--line-strong)]",children:[r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-[0.1em] text-[var(--ink-500)]",children:"Request"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-[0.1em] text-[var(--ink-500)]",children:"API"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-[0.1em] text-[var(--ink-500)]",children:"Model"}),r.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold uppercase tracking-[0.1em] text-[var(--ink-500)]",children:"Duration"}),r.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold uppercase tracking-[0.1em] text-[var(--ink-500)]",children:"Tokens"}),r.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold uppercase tracking-[0.1em] text-[var(--ink-500)]",children:"Cost"})]})}),r.jsx("tbody",{className:"divide-y divide-[var(--line-soft)]",children:f.items.slice(0,20).map(e=>(0,r.jsxs)("tr",{className:"hover:bg-[rgba(43,32,21,0.06)]",children:[r.jsx("td",{className:"px-4 py-3 text-sm text-[var(--ink-900)]",children:e.requestId}),r.jsx("td",{className:"px-4 py-3 text-sm text-[var(--ink-900)]",children:e.incomingApi.toUpperCase()}),r.jsx("td",{className:"px-4 py-3 text-sm text-[var(--ink-900)]",children:e.selectedModel||e.incomingModel}),(0,r.jsxs)("td",{className:"px-4 py-3 text-right text-sm text-[var(--ink-900)]",children:[e.durationMs,"ms"]}),r.jsx("td",{className:"px-4 py-3 text-right text-sm text-[var(--ink-900)]",children:e.totalTokens.toLocaleString()}),(0,r.jsxs)("td",{className:"px-4 py-3 text-right text-sm text-[var(--ink-900)]",children:["$",e.costUsd.toFixed(4)]})]},e.requestId))})]})})})]}),N&&r.jsx(o.Z,{title:"Performance Metrics",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 xl:grid-cols-4",children:[(0,r.jsxs)("div",{className:"rounded-lg border border-[var(--line-soft)] bg-[rgba(43,32,21,0.05)] p-4",children:[r.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.1em] text-[var(--ink-500)]",children:"TTFT p95"}),(0,r.jsxs)("p",{className:"mt-1 text-2xl font-semibold text-[var(--ink-900)]",children:[N.metrics.ttftMs.p95.toFixed(1),"ms"]})]}),(0,r.jsxs)("div",{className:"rounded-lg border border-[var(--line-soft)] bg-[rgba(43,32,21,0.05)] p-4",children:[r.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.1em] text-[var(--ink-500)]",children:"Latency p95"}),(0,r.jsxs)("p",{className:"mt-1 text-2xl font-semibold text-[var(--ink-900)]",children:[N.metrics.latencyMs.p95.toFixed(1),"ms"]})]}),(0,r.jsxs)("div",{className:"rounded-lg border border-[var(--line-soft)] bg-[rgba(43,32,21,0.05)] p-4",children:[r.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.1em] text-[var(--ink-500)]",children:"Latency p99"}),(0,r.jsxs)("p",{className:"mt-1 text-2xl font-semibold text-[var(--ink-900)]",children:[N.metrics.latencyMs.p99.toFixed(1),"ms"]})]}),(0,r.jsxs)("div",{className:"rounded-lg border border-[var(--line-soft)] bg-[rgba(43,32,21,0.05)] p-4",children:[r.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.1em] text-[var(--ink-500)]",children:"Error Rate"}),(0,r.jsxs)("p",{className:"mt-1 text-2xl font-semibold text-[var(--status-critical)]",children:[(100*N.metrics.errorRate).toFixed(2),"%"]})]})]})})]})})}},4174:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(8570).createProxy)(String.raw`/mnt/ollama/git/RADAPI01/web/src/app/reports/page.tsx#default`)}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[433,401,56],()=>s(9548));module.exports=r})();