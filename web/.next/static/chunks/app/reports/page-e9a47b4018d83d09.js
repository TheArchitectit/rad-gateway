(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[882],{1030:function(e,t,s){Promise.resolve().then(s.bind(s,629))},9280:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(2911).Z)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},257:function(e,t,s){"use strict";var r,a;e.exports=(null==(r=s.g.process)?void 0:r.env)&&"object"==typeof(null==(a=s.g.process)?void 0:a.env)?s.g.process:s(4227)},4227:function(e){!function(){var t={229:function(e){var t,s,r,a=e.exports={};function n(){throw Error("setTimeout has not been defined")}function i(){throw Error("clearTimeout has not been defined")}function l(e){if(t===setTimeout)return setTimeout(e,0);if((t===n||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(s){try{return t.call(null,e,0)}catch(s){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:n}catch(e){t=n}try{s="function"==typeof clearTimeout?clearTimeout:i}catch(e){s=i}}();var o=[],c=!1,d=-1;function x(){c&&r&&(c=!1,r.length?o=r.concat(o):d=-1,o.length&&u())}function u(){if(!c){var e=l(x);c=!0;for(var t=o.length;t;){for(r=o,o=[];++d<t;)r&&r[d].run();d=-1,t=o.length}r=null,c=!1,function(e){if(s===clearTimeout)return clearTimeout(e);if((s===i||!s)&&clearTimeout)return s=clearTimeout,clearTimeout(e);try{s(e)}catch(t){try{return s.call(null,e)}catch(t){return s.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function m(){}a.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var s=1;s<arguments.length;s++)t[s-1]=arguments[s];o.push(new h(e,t)),1!==o.length||c||l(u)},h.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=m,a.addListener=m,a.once=m,a.off=m,a.removeListener=m,a.removeAllListeners=m,a.emit=m,a.prependListener=m,a.prependOnceListener=m,a.listeners=function(e){return[]},a.binding=function(e){throw Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(e){throw Error("process.chdir is not supported")},a.umask=function(){return 0}}},s={};function r(e){var a=s[e];if(void 0!==a)return a.exports;var n=s[e]={exports:{}},i=!0;try{t[e](n,n.exports,r),i=!1}finally{i&&delete s[e]}return n.exports}r.ab="//";var a=r(229);e.exports=a}()},1961:function(e,t,s){"use strict";s.d(t,{Hx:function(){return n},x1:function(){return i}});let r=s(257).env.NEXT_PUBLIC_API_URL||"http://172.16.30.45:8090";class a{setAuthToken(e){this.authToken=e}getHeaders(){let e={"Content-Type":"application/json",Accept:"application/json"};return this.authToken&&(e.Authorization="Bearer ".concat(this.authToken)),e}buildUrl(e,t){let s=new URL("".concat(this.baseUrl).concat(e));return t&&Object.entries(t).forEach(e=>{let[t,r]=e;null!=r&&s.searchParams.set(t,String(r))}),s.toString()}async handleResponse(e){if(!e.ok){let t=await e.json().catch(()=>({error:{code:"unknown_error",message:"An unexpected error occurred"}}));throw new n(t.error.message,t.error.code,e.status,t.error.details,t.error.requestId)}if(204!==e.status)return e.json()}async get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=this.buildUrl(e,t.params),r=await fetch(s,{...t,method:"GET",headers:{...this.getHeaders(),...t.headers}});return this.handleResponse(r)}async post(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=this.buildUrl(e,s.params),a=await fetch(r,{...s,method:"POST",headers:{...this.getHeaders(),...s.headers},body:t?JSON.stringify(t):null});return this.handleResponse(a)}async put(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=this.buildUrl(e,s.params),a=await fetch(r,{...s,method:"PUT",headers:{...this.getHeaders(),...s.headers},body:t?JSON.stringify(t):null});return this.handleResponse(a)}async patch(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=this.buildUrl(e,s.params),a=await fetch(r,{...s,method:"PATCH",headers:{...this.getHeaders(),...s.headers},body:t?JSON.stringify(t):null});return this.handleResponse(a)}async delete(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=this.buildUrl(e,t.params),r=await fetch(s,{...t,method:"DELETE",headers:{...this.getHeaders(),...t.headers}});return this.handleResponse(r)}constructor(e){this.authToken=null,this.baseUrl=e.replace(/\/$/,"")}}class n extends Error{isUnauthorized(){return 401===this.status}isForbidden(){return 403===this.status}isNotFound(){return 404===this.status}isValidationError(){return 400===this.status||422===this.status}constructor(e,t,s,r,a){super(e),this.code=t,this.status=s,this.details=r,this.requestId=a,this.name="APIError"}}let i=new a(r)},629:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return u}});var r=s(7437),a=s(2265);let n=(0,s(2911).Z)("file-down",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);var i=s(9280),l=s(4892),o=s(6311),c=s(3141),d=s(1961);function x(e,t){let s=new Date(e);return Number.isNaN(s.getTime())?t:s.toISOString()}function u(){let e=(0,a.useMemo)(()=>(function(){let e=new Date;return{startTime:new Date(e.getTime()-6048e5).toISOString(),endTime:e.toISOString()}})(),[]),[t,s]=(0,a.useState)(""),[u,h]=(0,a.useState)(e.startTime.slice(0,16)),[m,p]=(0,a.useState)(e.endTime.slice(0,16)),[f,v]=(0,a.useState)(null),[g,j]=(0,a.useState)(""),[b,k]=(0,a.useState)(null),[y,N]=(0,a.useState)(null),[T,w]=(0,a.useState)(null),S=(0,a.useMemo)(()=>{let s={startTime:x(u,e.startTime),endTime:x(m,e.endTime)};return t.trim()&&(s.workspaceId=t.trim()),s},[u,m,t]),E=async()=>{v("usage"),j(""),N(null);try{let e=await d.x1.get("/v0/admin/reports/usage",{params:S});k(e)}catch(e){j(e instanceof Error?e.message:"Failed to load usage report")}finally{v(null)}},U=async()=>{v("performance"),j(""),k(null);try{let e=await d.x1.get("/v0/admin/reports/performance",{params:S});N(e)}catch(e){j(e instanceof Error?e.message:"Failed to load performance report")}finally{v(null)}},R=async e=>{v("export"),j("");try{let t=await d.x1.post("/v0/admin/reports/export",void 0,{params:{format:e}});w(t)}catch(e){j(e instanceof Error?e.message:"Failed to create report export")}finally{v(null)}};return(0,r.jsx)(l.L,{children:(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-[var(--ink-900)]",children:"Advanced Reports"}),(0,r.jsx)("p",{className:"text-[var(--ink-500)]",children:"Generate usage and performance dossiers with export-ready snapshots."})]}),(0,r.jsx)(o.Z,{children:(0,r.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 xl:grid-cols-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"mb-1.5 block text-xs font-semibold uppercase tracking-[0.1em] text-[var(--ink-500)]",children:"Workspace ID"}),(0,r.jsx)("input",{value:t,onChange:e=>s(e.target.value),placeholder:"Optional workspace",className:"ui-input"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"mb-1.5 block text-xs font-semibold uppercase tracking-[0.1em] text-[var(--ink-500)]",children:"Start Time"}),(0,r.jsx)("input",{type:"datetime-local",value:u,onChange:e=>h(e.target.value),className:"ui-input"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"mb-1.5 block text-xs font-semibold uppercase tracking-[0.1em] text-[var(--ink-500)]",children:"End Time"}),(0,r.jsx)("input",{type:"datetime-local",value:m,onChange:e=>p(e.target.value),className:"ui-input"})]}),(0,r.jsxs)("div",{className:"flex flex-wrap items-end gap-2",children:[(0,r.jsx)(c.z,{onClick:()=>void E(),loading:"usage"===f,children:"Load Usage"}),(0,r.jsx)(c.z,{variant:"secondary",onClick:()=>void U(),loading:"performance"===f,children:"Load Performance"})]})]})}),(0,r.jsx)(o.Z,{title:"Exports",children:(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,r.jsxs)(c.z,{variant:"secondary",onClick:()=>void R("json"),loading:"export"===f,children:[(0,r.jsx)(n,{className:"mr-2 h-4 w-4"}),"Export JSON"]}),(0,r.jsxs)(c.z,{variant:"secondary",onClick:()=>void R("csv"),loading:"export"===f,children:[(0,r.jsx)(n,{className:"mr-2 h-4 w-4"}),"Export CSV"]}),"export"===f&&(0,r.jsxs)("span",{className:"inline-flex items-center gap-2 text-sm text-[var(--ink-500)]",children:[(0,r.jsx)(i.Z,{className:"h-4 w-4 animate-spin"}),"Preparing export..."]}),T&&(0,r.jsxs)("div",{className:"text-sm text-[var(--ink-700)]",children:["Export ",(0,r.jsx)("span",{className:"font-semibold text-[var(--ink-900)]",children:T.exportId})," is ",T.status," \xb7"," ",(0,r.jsx)("a",{className:"text-[var(--status-info)] underline-offset-2 hover:underline",href:T.downloadUrl,children:"download"})]})]})}),g&&(0,r.jsx)(o.Z,{className:"border border-[rgba(152,43,33,0.3)] bg-[rgba(152,43,33,0.08)]",children:(0,r.jsx)("p",{className:"text-sm text-[var(--status-critical)]",children:g})}),b&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,r.jsxs)(o.Z,{children:[(0,r.jsx)("div",{className:"text-sm text-[var(--ink-500)]",children:"Requests"}),(0,r.jsx)("div",{className:"mt-1 text-2xl font-bold text-[var(--ink-900)]",children:b.summary.totalRequests.toLocaleString()})]}),(0,r.jsxs)(o.Z,{children:[(0,r.jsx)("div",{className:"text-sm text-[var(--ink-500)]",children:"Tokens"}),(0,r.jsx)("div",{className:"mt-1 text-2xl font-bold text-[var(--ink-900)]",children:b.summary.totalTokens.toLocaleString()})]}),(0,r.jsxs)(o.Z,{children:[(0,r.jsx)("div",{className:"text-sm text-[var(--ink-500)]",children:"Cost"}),(0,r.jsxs)("div",{className:"mt-1 text-2xl font-bold text-[var(--ink-900)]",children:["$",b.summary.totalCostUsd.toFixed(2)]})]}),(0,r.jsxs)(o.Z,{children:[(0,r.jsx)("div",{className:"text-sm text-[var(--ink-500)]",children:"Success Rate"}),(0,r.jsxs)("div",{className:"mt-1 text-2xl font-bold text-[var(--status-normal)]",children:[(100*b.summary.successRate).toFixed(2),"%"]})]})]}),(0,r.jsx)(o.Z,{title:"Usage Report Records",children:(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"border-b border-[var(--line-strong)]",children:[(0,r.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-[0.1em] text-[var(--ink-500)]",children:"Request"}),(0,r.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-[0.1em] text-[var(--ink-500)]",children:"API"}),(0,r.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-[0.1em] text-[var(--ink-500)]",children:"Model"}),(0,r.jsx)("th",{className:"px-4 py-3 text-right text-xs font-semibold uppercase tracking-[0.1em] text-[var(--ink-500)]",children:"Duration"}),(0,r.jsx)("th",{className:"px-4 py-3 text-right text-xs font-semibold uppercase tracking-[0.1em] text-[var(--ink-500)]",children:"Tokens"}),(0,r.jsx)("th",{className:"px-4 py-3 text-right text-xs font-semibold uppercase tracking-[0.1em] text-[var(--ink-500)]",children:"Cost"})]})}),(0,r.jsx)("tbody",{className:"divide-y divide-[var(--line-soft)]",children:b.items.slice(0,20).map(e=>(0,r.jsxs)("tr",{className:"hover:bg-[rgba(43,32,21,0.06)]",children:[(0,r.jsx)("td",{className:"px-4 py-3 text-sm text-[var(--ink-900)]",children:e.requestId}),(0,r.jsx)("td",{className:"px-4 py-3 text-sm text-[var(--ink-900)]",children:e.incomingApi.toUpperCase()}),(0,r.jsx)("td",{className:"px-4 py-3 text-sm text-[var(--ink-900)]",children:e.selectedModel||e.incomingModel}),(0,r.jsxs)("td",{className:"px-4 py-3 text-right text-sm text-[var(--ink-900)]",children:[e.durationMs,"ms"]}),(0,r.jsx)("td",{className:"px-4 py-3 text-right text-sm text-[var(--ink-900)]",children:e.totalTokens.toLocaleString()}),(0,r.jsxs)("td",{className:"px-4 py-3 text-right text-sm text-[var(--ink-900)]",children:["$",e.costUsd.toFixed(4)]})]},e.requestId))})]})})})]}),y&&(0,r.jsx)(o.Z,{title:"Performance Metrics",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 xl:grid-cols-4",children:[(0,r.jsxs)("div",{className:"rounded-lg border border-[var(--line-soft)] bg-[rgba(43,32,21,0.05)] p-4",children:[(0,r.jsx)("p",{className:"text-xs font-semibold uppercase tracking-[0.1em] text-[var(--ink-500)]",children:"TTFT p95"}),(0,r.jsxs)("p",{className:"mt-1 text-2xl font-semibold text-[var(--ink-900)]",children:[y.metrics.ttftMs.p95.toFixed(1),"ms"]})]}),(0,r.jsxs)("div",{className:"rounded-lg border border-[var(--line-soft)] bg-[rgba(43,32,21,0.05)] p-4",children:[(0,r.jsx)("p",{className:"text-xs font-semibold uppercase tracking-[0.1em] text-[var(--ink-500)]",children:"Latency p95"}),(0,r.jsxs)("p",{className:"mt-1 text-2xl font-semibold text-[var(--ink-900)]",children:[y.metrics.latencyMs.p95.toFixed(1),"ms"]})]}),(0,r.jsxs)("div",{className:"rounded-lg border border-[var(--line-soft)] bg-[rgba(43,32,21,0.05)] p-4",children:[(0,r.jsx)("p",{className:"text-xs font-semibold uppercase tracking-[0.1em] text-[var(--ink-500)]",children:"Latency p99"}),(0,r.jsxs)("p",{className:"mt-1 text-2xl font-semibold text-[var(--ink-900)]",children:[y.metrics.latencyMs.p99.toFixed(1),"ms"]})]}),(0,r.jsxs)("div",{className:"rounded-lg border border-[var(--line-soft)] bg-[rgba(43,32,21,0.05)] p-4",children:[(0,r.jsx)("p",{className:"text-xs font-semibold uppercase tracking-[0.1em] text-[var(--ink-500)]",children:"Error Rate"}),(0,r.jsxs)("p",{className:"mt-1 text-2xl font-semibold text-[var(--status-critical)]",children:[(100*y.metrics.errorRate).toFixed(2),"%"]})]})]})})]})})}}},function(e){e.O(0,[15,735,971,117,744],function(){return e(e.s=1030)}),_N_E=e.O()}]);