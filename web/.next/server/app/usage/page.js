(()=>{var e={};e.id=956,e.ids=[956],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},18486:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>x,pages:()=>c,routeModule:()=>p,tree:()=>d}),s(72080),s(21740),s(35866);var a=s(23191),r=s(88716),i=s(37922),n=s.n(i),l=s(95231),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);s.d(t,o);let d=["",{children:["usage",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,72080)),"/mnt/ollama/git/RADAPI01/web/src/app/usage/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,21740)),"/mnt/ollama/git/RADAPI01/web/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"]}],c=["/mnt/ollama/git/RADAPI01/web/src/app/usage/page.tsx"],x="/usage/page",m={require:s,loadChunk:()=>Promise.resolve()},p=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/usage/page",pathname:"/usage",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},74141:(e,t,s)=>{Promise.resolve().then(s.bind(s,56700))},56700:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>u});var a=s(10326),r=s(17577);let i=(0,s(25578).Z)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]);var n=s(48350),l=s(55030),o=s(14583),d=s(65043),c=s(80002),x=s(51547),m=s(5874);let p=[{value:"24h",label:"Last 24 hours",hours:24},{value:"7d",label:"Last 7 days",hours:168},{value:"30d",label:"Last 30 days",hours:720}];function u(){let[e,t]=(0,r.useState)("24h"),[s,u]=(0,r.useState)(void 0),h=(0,r.useMemo)(()=>(function(e){let t=p.find(t=>t.value===e)||p[0],s=new Date;return{startTime:new Date(s.getTime()-36e5*t.hours).toISOString(),endTime:s.toISOString()}})(e),[e]),{data:v,isLoading:g,error:j}=(0,m.LD)(h),{data:k,isLoading:f,error:y}=(0,m.HN)({...h,page:1,pageSize:25}),{data:N,isLoading:b}=(0,m.Pj)({startTime:h.startTime,endTime:h.endTime,interval:"24h"===e?"hour":"day"}),T=(0,m.IQ)("providerId",h),w=(0,m.n)({onSuccess:e=>u(e.exportId)}),S=(0,m.Fn)(s),C=(0,r.useMemo)(()=>{let e=Object.entries(T.data).map(([e,t])=>({providerName:e,requestCount:Number(t.requestCount||0),totalTokens:Number(t.totalTokens||0),costUsd:Number(t.costUsd||0)}));if(e.length>0)return e.sort((e,t)=>t.requestCount-e.requestCount);let t=new Map;return(k?.data||[]).forEach(e=>{let s=e.providerId||"unknown",a=t.get(s)||{requestCount:0,totalTokens:0,costUsd:0};a.requestCount+=1,a.totalTokens+=e.totalTokens,a.costUsd+=e.costUsd||0,t.set(s,a)}),Array.from(t.entries()).map(([e,t])=>({providerName:e,...t}))},[T.data,k?.data]),q=k?.data||[],P=async e=>{await w.mutateAsync({startTime:h.startTime,endTime:h.endTime,format:e,includeCost:!0})};return a.jsx(n.L,{children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex flex-col justify-between gap-3 md:flex-row md:items-center",children:[(0,a.jsxs)("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-[var(--ink-900)]",children:"Usage Command Deck"}),a.jsx("p",{className:"text-[var(--ink-500)]",children:"Operational usage intelligence with export-ready telemetry."})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-3",children:[a.jsx("select",{value:e,onChange:e=>t(e.target.value),className:"ui-input max-w-[180px]",children:p.map(e=>a.jsx("option",{value:e.value,children:e.label},e.value))}),(0,a.jsxs)(o.z,{variant:"secondary",onClick:()=>void P("csv"),loading:w.isPending,children:[a.jsx(i,{className:"mr-2 h-4 w-4"}),"Export CSV"]})]})]}),(j||y)&&a.jsx(l.Z,{className:"border border-[rgba(152,43,33,0.3)] bg-[rgba(152,43,33,0.08)]",children:a.jsx("p",{className:"text-sm text-[var(--status-critical)]",children:(j||y)?.message||"Failed to load usage telemetry."})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-5",children:[(0,a.jsxs)(l.Z,{children:[a.jsx("div",{className:"text-sm text-[var(--ink-500)]",children:"Total Requests"}),a.jsx("div",{className:"mt-1 text-2xl font-bold text-[var(--ink-900)]",children:g?"...":(v?.totalRequests||0).toLocaleString()})]}),(0,a.jsxs)(l.Z,{children:[a.jsx("div",{className:"text-sm text-[var(--ink-500)]",children:"Total Tokens"}),a.jsx("div",{className:"mt-1 text-2xl font-bold text-[var(--ink-900)]",children:g?"...":`${((v?.totalTokens||0)/1e6).toFixed(2)}M`})]}),(0,a.jsxs)(l.Z,{children:[a.jsx("div",{className:"text-sm text-[var(--ink-500)]",children:"Total Cost"}),a.jsx("div",{className:"mt-1 text-2xl font-bold text-[var(--ink-900)]",children:g?"...":`$${(v?.totalCostUsd||0).toFixed(2)}`})]}),(0,a.jsxs)(l.Z,{children:[a.jsx("div",{className:"text-sm text-[var(--ink-500)]",children:"Avg Latency"}),a.jsx("div",{className:"mt-1 text-2xl font-bold text-[var(--ink-900)]",children:g?"...":`${Math.round(v?.avgDurationMs||0)}ms`})]}),(0,a.jsxs)(l.Z,{children:[a.jsx("div",{className:"text-sm text-[var(--ink-500)]",children:"Error Rate"}),a.jsx("div",{className:"mt-1 text-2xl font-bold text-[var(--status-critical)]",children:g?"...":`${(v?.errorRate||0).toFixed(2)}%`})]})]}),b?(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-2",children:[a.jsx(l.Z,{children:a.jsx("div",{className:"h-[300px] flex items-center justify-center",children:a.jsx("div",{className:"text-[var(--ink-500)]",children:"Loading charts..."})})}),a.jsx(l.Z,{children:a.jsx("div",{className:"h-[300px] flex items-center justify-center",children:a.jsx("div",{className:"text-[var(--ink-500)]",children:"Loading charts..."})})})]}):(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-2",children:[a.jsx(c.I,{data:N?.points?.map(e=>({timestamp:e.timestamp,requests:e.requestCount,errors:e.errorCount}))||[],title:"Request Volume"}),a.jsx(x.j,{data:N?.points?.map(e=>({timestamp:e.timestamp,input:Math.round(.4*e.tokenCount),output:Math.round(.6*e.tokenCount),reasoning:0,cached:0}))||[],title:"Token Usage"})]}),a.jsx(l.Z,{title:"Usage by Provider",children:(0,a.jsxs)("div",{className:"space-y-4",children:[0===C.length&&!f&&a.jsx("p",{className:"text-sm text-[var(--ink-500)]",children:"No provider usage data available for this range."}),C.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between rounded-lg border border-[var(--line-soft)] bg-[rgba(43,32,21,0.06)] px-4 py-3",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"font-medium text-[var(--ink-900)]",children:e.providerName}),(0,a.jsxs)("p",{className:"text-sm text-[var(--ink-500)]",children:[e.requestCount.toLocaleString()," requests \xb7 ",(e.totalTokens/1e6).toFixed(2),"M tokens"]})]}),(0,a.jsxs)("p",{className:"font-semibold text-[var(--ink-900)]",children:["$",e.costUsd.toFixed(2)]})]},e.providerName))]})}),a.jsx(l.Z,{title:"Recent Usage Records",children:a.jsx("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[a.jsx("thead",{children:(0,a.jsxs)("tr",{className:"border-b border-[var(--line-strong)]",children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-[0.1em] text-[var(--ink-500)]",children:"Started"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-[0.1em] text-[var(--ink-500)]",children:"Provider"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-[0.1em] text-[var(--ink-500)]",children:"Model"}),a.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold uppercase tracking-[0.1em] text-[var(--ink-500)]",children:"Tokens"}),a.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold uppercase tracking-[0.1em] text-[var(--ink-500)]",children:"Cost"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-[0.1em] text-[var(--ink-500)]",children:"Status"})]})}),(0,a.jsxs)("tbody",{className:"divide-y divide-[var(--line-soft)]",children:[f&&a.jsx("tr",{children:a.jsx("td",{colSpan:6,className:"px-4 py-6 text-sm text-[var(--ink-500)]",children:"Loading usage records..."})}),!f&&0===q.length&&a.jsx("tr",{children:a.jsx("td",{colSpan:6,className:"px-4 py-6 text-sm text-[var(--ink-500)]",children:"No usage records in this range."})}),q.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-[rgba(43,32,21,0.05)]",children:[a.jsx("td",{className:"px-4 py-3 text-sm text-[var(--ink-900)]",children:new Date(e.startedAt).toLocaleString()}),a.jsx("td",{className:"px-4 py-3 text-sm text-[var(--ink-900)]",children:e.providerId||"unknown"}),a.jsx("td",{className:"px-4 py-3 text-sm text-[var(--ink-900)]",children:e.selectedModel||e.incomingModel}),a.jsx("td",{className:"px-4 py-3 text-right text-sm text-[var(--ink-900)]",children:e.totalTokens.toLocaleString()}),(0,a.jsxs)("td",{className:"px-4 py-3 text-right text-sm text-[var(--ink-900)]",children:["$",(e.costUsd||0).toFixed(4)]}),a.jsx("td",{className:"px-4 py-3",children:a.jsx(d.C,{color:"success"===e.responseStatus?"success":"error",children:e.responseStatus})})]},e.id))]})]})})}),(w.data||S.data)&&a.jsx(l.Z,{title:"Export Status",children:(0,a.jsxs)("div",{className:"space-y-2 text-sm text-[var(--ink-700)]",children:[(0,a.jsxs)("p",{children:["Export ID: ",a.jsx("span",{className:"font-semibold text-[var(--ink-900)]",children:(S.data||w.data)?.exportId})]}),(0,a.jsxs)("p",{children:["Status: ",a.jsx("span",{className:"font-semibold text-[var(--ink-900)]",children:(S.data||w.data)?.status})]}),(S.data||w.data)?.downloadUrl&&a.jsx("a",{href:(S.data||w.data)?.downloadUrl,className:"text-[var(--status-info)] underline-offset-2 hover:underline",children:"Download export payload"})]})})]})})}},51547:(e,t,s)=>{"use strict";s.d(t,{j:()=>p});var a=s(10326);s(17577);var r=s(81398),i=s(49844),n=s(18423),l=s(62637),o=s(9997),d=s(89495),c=s(41449),x=s(18089),m=s(55030);let p=({data:e,title:t="Token Usage",className:s})=>{let p=e=>new Date(e).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return a.jsx(m.Z,{className:s,children:(0,a.jsxs)("div",{className:"p-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-[var(--ink-900)] mb-4",children:t}),a.jsx("div",{className:"h-[300px]",children:a.jsx(r.h,{width:"100%",height:"100%",children:(0,a.jsxs)(i.v,{data:e,margin:{top:10,right:30,left:0,bottom:0},children:[a.jsx(n.q,{strokeDasharray:"3 3",stroke:"var(--line-soft)"}),a.jsx(l.K,{dataKey:"timestamp",tickFormatter:p,stroke:"var(--ink-500)",tick:{fill:"var(--ink-500)",fontSize:12}}),a.jsx(o.B,{stroke:"var(--ink-500)",tick:{fill:"var(--ink-500)",fontSize:12},tickFormatter:e=>`${(e/1e3).toFixed(0)}k`}),a.jsx(d.u,{contentStyle:{backgroundColor:"var(--panel)",border:"1px solid var(--line-soft)",borderRadius:"8px"},labelFormatter:e=>p(e)}),a.jsx(c.D,{}),a.jsx(x.$Q,{dataKey:"input",stackId:"tokens",fill:"#3B82F6",name:"Input Tokens",radius:[0,0,4,4]}),a.jsx(x.$Q,{dataKey:"output",stackId:"tokens",fill:"#10B981",name:"Output Tokens"}),a.jsx(x.$Q,{dataKey:"reasoning",stackId:"tokens",fill:"#8B5CF6",name:"Reasoning Tokens"}),a.jsx(x.$Q,{dataKey:"cached",stackId:"tokens",fill:"#F59E0B",name:"Cached Tokens",radius:[4,4,0,0]})]})})})]})})}},80002:(e,t,s)=>{"use strict";s.d(t,{I:()=>m});var a=s(10326);s(17577);var r=s(81398),i=s(10669),n=s(18423),l=s(62637),o=s(9997),d=s(89495),c=s(50721),x=s(55030);let m=({data:e,title:t="Requests Over Time",showErrors:s=!0,className:m})=>{let p=e=>new Date(e).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return a.jsx(x.Z,{className:m,children:(0,a.jsxs)("div",{className:"p-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-[var(--ink-900)] mb-4",children:t}),a.jsx("div",{className:"h-[300px]",children:a.jsx(r.h,{width:"100%",height:"100%",children:(0,a.jsxs)(i.T,{data:e,margin:{top:10,right:30,left:0,bottom:0},children:[(0,a.jsxs)("defs",{children:[(0,a.jsxs)("linearGradient",{id:"colorRequests",x1:"0",y1:"0",x2:"0",y2:"1",children:[a.jsx("stop",{offset:"5%",stopColor:"#B18532",stopOpacity:.3}),a.jsx("stop",{offset:"95%",stopColor:"#B18532",stopOpacity:0})]}),(0,a.jsxs)("linearGradient",{id:"colorErrors",x1:"0",y1:"0",x2:"0",y2:"1",children:[a.jsx("stop",{offset:"5%",stopColor:"#EF4444",stopOpacity:.3}),a.jsx("stop",{offset:"95%",stopColor:"#EF4444",stopOpacity:0})]})]}),a.jsx(n.q,{strokeDasharray:"3 3",stroke:"var(--line-soft)"}),a.jsx(l.K,{dataKey:"timestamp",tickFormatter:p,stroke:"var(--ink-500)",tick:{fill:"var(--ink-500)",fontSize:12}}),a.jsx(o.B,{stroke:"var(--ink-500)",tick:{fill:"var(--ink-500)",fontSize:12},tickFormatter:e=>e.toLocaleString()}),a.jsx(d.u,{contentStyle:{backgroundColor:"var(--panel)",border:"1px solid var(--line-soft)",borderRadius:"8px"},labelFormatter:e=>p(e)}),a.jsx(c.uN,{type:"monotone",dataKey:"requests",stroke:"#B18532",strokeWidth:2,fillOpacity:1,fill:"url(#colorRequests)",name:"Requests"}),s&&a.jsx(c.uN,{type:"monotone",dataKey:"errors",stroke:"#EF4444",strokeWidth:2,fillOpacity:1,fill:"url(#colorErrors)",name:"Errors"})]})})})]})})}},72080:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});let a=(0,s(68570).createProxy)(String.raw`/mnt/ollama/git/RADAPI01/web/src/app/usage/page.tsx#default`)},41135:(e,t,s)=>{"use strict";function a(){for(var e,t,s=0,a="",r=arguments.length;s<r;s++)(e=arguments[s])&&(t=function e(t){var s,a,r="";if("string"==typeof t||"number"==typeof t)r+=t;else if("object"==typeof t){if(Array.isArray(t)){var i=t.length;for(s=0;s<i;s++)t[s]&&(a=e(t[s]))&&(r&&(r+=" "),r+=a)}else for(a in t)t[a]&&(r&&(r+=" "),r+=a)}return r}(e))&&(a&&(a+=" "),a+=t);return a}s.d(t,{W:()=>a})}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[433,378,463,187,56,474,422],()=>s(18486));module.exports=a})();