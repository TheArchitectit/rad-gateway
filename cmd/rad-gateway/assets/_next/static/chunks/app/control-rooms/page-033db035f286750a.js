(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[910],{8633:function(e,t,s){Promise.resolve().then(s.bind(s,7982))},9322:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(8755).Z)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},7982:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return f}});var a=s(7437),l=s(2265),i=s(9397);let r=(0,s(8755).Z)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);var n=s(9322),c=s(4401),o=s(1239),d=s(6137),m=s(4892),u=s(6311),x=s(3141),h=s(7943),v=s(4581);let g="rad-control-rooms-v1",p=[{id:"room-main",name:"Main Engine Room",description:"Global command view for all providers and traffic.",tags:["scope:all","layout:grid"],layout:"grid",isDefault:!0},{id:"room-cost",name:"Cost Sentinel",description:"Focused on usage economics and error drift.",tags:["metric:cost","metric:error"],layout:"compact"},{id:"room-openai",name:"OpenAI Pressure Deck",description:"Dedicated monitoring lane for OpenAI traffic.",tags:["provider:openai"],layout:"list"}];function f(){var e;let[t,s]=(0,l.useState)(p),[f,j]=(0,l.useState)((null===(e=p[0])||void 0===e?void 0:e.id)||""),[N,y]=(0,l.useState)(""),[b,k]=(0,l.useState)(""),[w,C]=(0,l.useState)(""),M=(0,l.useMemo)(()=>(function(){let e=new Date;return{startTime:new Date(e.getTime()-216e5).toISOString(),endTime:e.toISOString()}})(),[]),{data:Z,isLoading:D}=(0,v.ko)(),{data:S,isLoading:O}=(0,v.LD)(M),{data:A,isLoading:E}=(0,v.HN)({...M,page:1,pageSize:15});(0,l.useEffect)(()=>{var e,t;let a=window.localStorage.getItem(g);if(a)try{let t=JSON.parse(a);Array.isArray(t)&&t.length>0&&(s(t),j((null===(e=t[0])||void 0===e?void 0:e.id)||""))}catch(e){s(p),j((null===(t=p[0])||void 0===t?void 0:t.id)||"")}},[]),(0,l.useEffect)(()=>{window.localStorage.setItem(g,JSON.stringify(t))},[t]);let R=function(e,t){if(!t||t.tags.includes("scope:all"))return e;let s=t.tags.filter(e=>e.startsWith("provider:")).map(e=>e.replace("provider:","").trim()),a=t.tags.filter(e=>e.startsWith("status:")).map(e=>e.replace("status:","").trim());return e.filter(e=>{let t=e.name.toLowerCase();return(!(s.length>0)||!!s.some(e=>t.includes(e)))&&(!(a.length>0)||!!a.includes(e.status))})}((null==Z?void 0:Z.providers)||[],t.find(e=>e.id===f)),L={healthy:R.filter(e=>"healthy"===e.status).length,degraded:R.filter(e=>"degraded"===e.status).length,unhealthy:R.filter(e=>"unhealthy"===e.status).length},I=((null==S?void 0:S.totalRequests)||0)/360,P=(null==S?void 0:S.avgDurationMs)||0,H=(null==S?void 0:S.errorRate)||0,_=(0,l.useMemo)(()=>{let e=[];return R.forEach(t=>{"unhealthy"===t.status?e.push({level:"critical",message:"".concat(t.displayName||t.name," is unhealthy"),time:"live"}):"degraded"===t.status&&e.push({level:"warning",message:"".concat(t.displayName||t.name," latency is degraded"),time:"live"})}),H>2&&e.push({level:"critical",message:"Error rate elevated at ".concat(H.toFixed(2),"%"),time:"window"}),P>900&&e.push({level:"warning",message:"Latency threshold breach: ".concat(Math.round(P),"ms"),time:"window"}),0===e.length&&e.push({level:"info",message:"No active alerts in this control room.",time:"live"}),e.slice(0,6)},[P,H,R]),F=e=>{let a=t.filter(t=>t.id!==e);if(s(a.length>0?a:p),f===e){let e=a[0]||p[0];j((null==e?void 0:e.id)||"")}},T=D||O||E;return(0,a.jsx)(m.L,{children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-[var(--ink-900)]",children:"Control Rooms"}),(0,a.jsx)("p",{className:"text-[var(--ink-500)]",children:"Foglight-style operational stations tuned by tags, scope, and monitoring posture."})]}),(0,a.jsx)(u.Z,{children:(0,a.jsxs)("div",{className:"grid gap-3 md:grid-cols-2 xl:grid-cols-4",children:[(0,a.jsx)("input",{value:N,onChange:e=>y(e.target.value),placeholder:"Room name",className:"ui-input"}),(0,a.jsx)("input",{value:b,onChange:e=>k(e.target.value),placeholder:"Description",className:"ui-input"}),(0,a.jsx)("input",{value:w,onChange:e=>C(e.target.value),placeholder:"Tags (provider:openai,status:degraded)",className:"ui-input"}),(0,a.jsxs)(x.z,{onClick:()=>{if(!N.trim())return;let e={id:"room-".concat(Date.now()),name:N.trim(),description:b.trim()||"Custom control room",tags:w.split(",").map(e=>e.trim().toLowerCase()).filter(e=>e.length>0),layout:"grid"};s(t=>[e,...t]),j(e.id),y(""),k(""),C("")},children:[(0,a.jsx)(i.Z,{className:"mr-2 h-4 w-4"}),"Create Room"]})]})})]}),(0,a.jsx)(u.Z,{title:"Available Rooms",children:(0,a.jsx)("div",{className:"grid gap-3 md:grid-cols-2 xl:grid-cols-3",children:t.map(e=>{let t=e.id===f;return(0,a.jsxs)("button",{type:"button",onClick:()=>j(e.id),className:"rounded-lg border p-4 text-left transition-colors ".concat(t?"border-[var(--brass-500)] bg-[rgba(177,133,50,0.16)]":"border-[var(--line-soft)] bg-[rgba(43,32,21,0.06)] hover:bg-[rgba(43,32,21,0.12)]"),children:[(0,a.jsxs)("div",{className:"mb-2 flex items-center justify-between gap-2",children:[(0,a.jsx)("p",{className:"font-semibold text-[var(--ink-900)]",children:e.name}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[e.isDefault&&(0,a.jsx)(h.O,{status:"active"}),!e.isDefault&&(0,a.jsx)("span",{role:"button",tabIndex:0,onClick:t=>{t.stopPropagation(),F(e.id)},onKeyDown:t=>{("Enter"===t.key||" "===t.key)&&(t.preventDefault(),F(e.id))},className:"rounded-md p-1 text-[var(--ink-500)] hover:bg-[rgba(43,32,21,0.12)]",children:(0,a.jsx)(r,{className:"h-4 w-4"})})]})]}),(0,a.jsx)("p",{className:"mb-2 text-sm text-[var(--ink-500)]",children:e.description}),(0,a.jsx)("p",{className:"text-xs uppercase tracking-[0.08em] text-[var(--ink-500)]",children:e.tags.length>0?e.tags.join(" \xb7 "):"No filters"})]},e.id)})})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,a.jsxs)(u.Z,{children:[(0,a.jsx)("div",{className:"text-sm text-[var(--ink-500)]",children:"Requests / Min"}),(0,a.jsx)("div",{className:"mt-1 text-2xl font-bold text-[var(--ink-900)]",children:T?"...":I.toFixed(1)})]}),(0,a.jsxs)(u.Z,{children:[(0,a.jsx)("div",{className:"text-sm text-[var(--ink-500)]",children:"Avg Latency"}),(0,a.jsx)("div",{className:"mt-1 text-2xl font-bold text-[var(--ink-900)]",children:T?"...":"".concat(Math.round(P),"ms")})]}),(0,a.jsxs)(u.Z,{children:[(0,a.jsx)("div",{className:"text-sm text-[var(--ink-500)]",children:"Error Rate"}),(0,a.jsx)("div",{className:"mt-1 text-2xl font-bold text-[var(--status-critical)]",children:T?"...":"".concat(H.toFixed(2),"%")})]}),(0,a.jsxs)(u.Z,{children:[(0,a.jsx)("div",{className:"text-sm text-[var(--ink-500)]",children:"Healthy Providers"}),(0,a.jsx)("div",{className:"mt-1 text-2xl font-bold text-[var(--ink-900)]",children:T?"...":"".concat(L.healthy,"/").concat(R.length)})]})]}),(0,a.jsx)(u.Z,{title:"Provider Health Mesh",children:(0,a.jsxs)("div",{className:"space-y-3",children:[0===R.length&&!T&&(0,a.jsx)("p",{className:"text-sm text-[var(--ink-500)]",children:"No providers match this control room scope."}),R.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between rounded-lg border border-[var(--line-soft)] bg-[rgba(43,32,21,0.06)] px-4 py-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-[var(--ink-900)]",children:e.displayName||e.name}),(0,a.jsxs)("p",{className:"text-sm text-[var(--ink-500)]",children:["Circuit ",e.circuitBreaker," \xb7 ",e.latencyMs?"".concat(e.latencyMs,"ms"):"No latency sample"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(h.O,{status:e.status,showPulse:"healthy"===e.status}),(0,a.jsx)(h.O,{status:e.circuitBreaker})]})]},e.id))]})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-2",children:[(0,a.jsx)(u.Z,{title:"Recent Alerts",children:(0,a.jsx)("div",{className:"space-y-3",children:_.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-start gap-3 rounded-lg border border-[var(--line-soft)] bg-[rgba(43,32,21,0.06)] px-3 py-2",children:[(0,a.jsx)(n.Z,{className:"mt-0.5 h-5 w-5 ".concat("critical"===e.level?"text-[var(--status-critical)]":"warning"===e.level?"text-[var(--status-warning)]":"text-[var(--status-info)]")}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-[var(--ink-900)]",children:e.message}),(0,a.jsx)("p",{className:"text-xs text-[var(--ink-500)]",children:e.time})]})]},"".concat(e.message,"-").concat(t)))})}),(0,a.jsx)(u.Z,{title:"Telemetry Events",children:(0,a.jsxs)("div",{className:"space-y-3",children:[((null==A?void 0:A.data)||[]).slice(0,6).map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between rounded-lg border border-[var(--line-soft)] bg-[rgba(43,32,21,0.06)] px-3 py-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:["chat"===e.incomingApi?(0,a.jsx)(c.Z,{className:"h-4 w-4 text-[var(--status-info)]"}):"responses"===e.incomingApi?(0,a.jsx)(o.Z,{className:"h-4 w-4 text-[var(--brass-700)]"}):(0,a.jsx)(d.Z,{className:"h-4 w-4 text-[var(--ink-500)]"}),(0,a.jsxs)("span",{className:"text-sm text-[var(--ink-700)]",children:[e.incomingApi.toUpperCase()," \xb7 ",e.selectedModel||e.incomingModel]})]}),(0,a.jsxs)("span",{className:"text-xs text-[var(--ink-500)]",children:[e.durationMs,"ms"]})]},e.id)),!E&&0===((null==A?void 0:A.data)||[]).length&&(0,a.jsx)("p",{className:"text-sm text-[var(--ink-500)]",children:"No recent telemetry events in selected window."})]})})]})]})})}},7943:function(e,t,s){"use strict";s.d(t,{O:function(){return r}});var a=s(7437);s(2265);var l=s(6269);let i={healthy:{color:"success",label:"Healthy"},degraded:{color:"warning",label:"Degraded"},unhealthy:{color:"error",label:"Unhealthy"},disabled:{color:"default",label:"Disabled"},pending:{color:"info",label:"Pending"},active:{color:"success",label:"Active"},inactive:{color:"default",label:"Inactive"},closed:{color:"success",label:"Closed"},open:{color:"error",label:"Open"},"half-open":{color:"warning",label:"Half-Open"}};function r(e){let{status:t,showPulse:s=!1}=e,r=i[t];return(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[s&&"healthy"===t&&(0,a.jsxs)("span",{className:"relative flex h-2 w-2",children:[(0,a.jsx)("span",{className:"absolute inline-flex h-full w-full animate-ping rounded-full bg-[rgba(47,122,79,0.55)] opacity-75"}),(0,a.jsx)("span",{className:"relative inline-flex h-2 w-2 rounded-full bg-[var(--status-normal)]"})]}),(0,a.jsx)(l.C,{color:r.color,children:r.label})]})}}},function(e){e.O(0,[142,954,909,608,735,402,534,971,117,744],function(){return e(e.s=8633)}),_N_E=e.O()}]);